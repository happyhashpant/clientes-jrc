<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <script src="/assets/jquery-3.6.0.min.js"></script>
    <script src="/assets/bootstrap.js"></script>
    <script defer src="/assets/functions.js"></script>
    <link rel="stylesheet" href="/assets/normalize.css" />
    <link rel="stylesheet" href="/assets/bootstrap.min.css" />
    <link rel="stylesheet" href="/assets/styles.css" />
    <link rel="icon" href="/assets/logo.png" />
    <title><%=business[0].businessName%></title>
  </head>
  <body>
    <div id="navBar"></div>
    <h1><%=business[0].businessName%></h1>

    <form id="generalData" class="addUserForm" method="post">
      <h2>Datos Generales</h2>
      <div class="editButtons">
        <button
          type="button"
          class="button"
          id="editGeneralData"
          onclick="editGeneralDataDiv()"
        >
          <i class="material-icons">mode_edit</i>
          <span class="text">Editar</span>
        </button>
      </div>
      <div class="editButtons">
        <button type="submit" class="button hiddenButton" id="saveGeneralData">
          <i class="material-icons">sd_card</i>
          <span class="text">Guardar</span>
        </button>
      </div>
      <div class="contentBackground">
        <div class="row">
          <div class="col-md-4">
            <label for="">Nombre de la sociedad</label>
            <input
              id="businessName"
              type="text"
              class="form-control"
              name="businessName"
              placeholder="Nombre de la sociedad"
              value="<%=business[0].businessName%>"
              readonly
            />
          </div>
          <div class="col-md-4">
            <label for="">Cedula Juridica</label>
            <input
              name="businessID2"
              type="hidden"
              value="<%=business[0].id%>"
            />
            <input
              id="businessID"
              type="number"
              class="form-control"
              name="businessID"
              placeholder="Cedula Juridica"
              value="<%=business[0].businessID%>"
              readonly
            />
          </div>
        </div>
      </div>
    </form>
    <form
      id="ownerData"
      class="addUserForm needs-validation"
      method="post"
      novalidate
    >
      <input
        name="businessID"
        type="hidden"
        value="<%=business[0].businessID%>"
      />
      <h2>Representante Legal</h2>
      <div class="editButtons">
        <div class="editButtons">
          <button
            type="button"
            class="button"
            id="editOwner"
            onclick="editOwnerData()"
          >
            <i class="material-icons">mode_edit</i>
            <span class="text">Editar</span>
          </button>
        </div>
      </div>
      <div class="editButtons">
        <button
          type="submit"
          class="button hiddenButton"
          id="saveOwnerDataButton"
        >
          <i class="material-icons">sd_card</i>
          <span class="text">Guardar</span>
        </button>
      </div>
      <div class="editButtons">
        <button
          type="button"
          class="button hiddenButton"
          id="addOwnerButton"
          onclick="clonOwner2()"
        >
          <i class="material-icons">add</i>
          <span class="text">Agregar representante</span>
        </button>
      </div>
      <div class="contentBackground">
        <div id="addOwner">
          <% var i=1; owner.forEach(function(data){%>
          <div id="ownerDIV1" class="ownerDIV <%=data.idLegal%>">
            <div
              class="col-md-6 divDeleteButtonOwner"
              id="divDeleteButtonOwner"
            >
              <button
                type="button"
                class="edit"
                id="deleteButtonOwner"
                onclick="deleteOwnerAjx('<%=business[0].businessID%>','<%=data.idLegal%>')"
              >
                <i class="deleteIcon material-icons">clear</i>
              </button>
            </div>
            <div class="row" id="ownerRow">
              <div class="col-md-4" id="ownerNameInput">
                <label for="">Nombre del Representante</label>
                <input
                  type="text"
                  class="form-control businessOwnerName"
                  id="businessOwnerName"
                  name="currentBusinessOwnerName"
                  placeholder="Nombre del Representante"
                  value="<%=data.nameLegal%>"
                  readonly
                  required
                />
              </div>
              <div class="col-md-4" id="ownerIDInput">
                <label for="">Cedula del Representante</label>
                <input
                  type="text"
                  class="form-control businessOwnerID"
                  name="currentBusinessOwnerID"
                  id="businessOwnerID"
                  value="<%=data.idLegal%>"
                  placeholder="Cedula del Representante"
                  readonly
                  required
                />
              </div>
              <div class="col-md-4" id="ownerIDExpDateInput">
                <label for="">Fecha de expiracion de la Cedula</label>
                <input
                  type="date"
                  class="form-control ownerIDExpDate"
                  id="ownerIDExpDate"
                  name="currentOwnerIDExpDate"
                  value="<%=data.dateIdExpiration%>"
                  placeholder="Fecha de expiracion de la Cedula"
                  readonly
                  required
                />
              </div>
            </div>
            <div class="row" id="ownerSecRow">
              <div class="col-md-4" id="ownerBirDateToolInput">
                <label for="">Fecha de nacimiento</label>
                <input
                  type="date"
                  class="form-control ownerBirDate"
                  name="currentOwnerBirDate"
                  id="ownerBirDate"
                  value="<%=data.dateBirthLegal%>"
                  placeholder="Fecha de nacimiento"
                  readonly
                  required
                />
              </div>
              <div class="col-md-4" id="ownerAddressInput">
                <label for="">Domicilio</label>
                <input
                  type="text"
                  class="form-control ownerAddress"
                  id="ownerAddress"
                  name="currentOwnerAddress"
                  value="<%=data.address%>"
                  placeholder="Domicilio"
                  readonly
                  required
                />
              </div>
            </div>
            <div class="row" id="ownerThrRow">
              <div class="col-md-6" id="ownerDeleteButtonInput"></div>
            </div>
          </div>
          <% i++; }) %>
        </div>
      </div>
    </form>
    <form id="accountData" class="addUserForm">
      <h2>Datos contables</h2>
      <input
        name="businessID"
        type="hidden"
        value="<%=business[0].businessID%>"
      />
      <div class="editButtons">
        <button
          type="button"
          class="button"
          id="editAccountData"
          onclick="editAccountsData()"
        >
          <i class="material-icons">mode_edit</i>
          <span class="text">Editar</span>
        </button>
      </div>
      <div class="editButtons">
        <button type="submit" class="button hiddenButton" id="saveAccountData">
          <i class="material-icons">sd_card</i>
          <span class="text">Guardar</span>
        </button>
      </div>
      <div class="contentBackground">
        <div class="row">
          <div class="col-md-6">
            <label for="">Usuario ATV</label>
            <input
              type="text"
              class="form-control"
              id="atvUser"
              name="atvUser"
              placeholder="Usuario ATV"
              value="<%=business[0].atvUser%>"
              readonly
            />
          </div>
          <div class="col-md-6">
            <label for="">Contrase単a ATV</label>
            <input
              type="text"
              class="form-control"
              id="atvPassword"
              name="atvPassword"
              placeholder="Contrase単a ATV"
              value="<%=business[0].atvPassword%>"
              readonly
            />
          </div>
        </div>
        <div class="row">
          <div class="col-md-4">
            <label for="">Sistema de Facturacion</label>
            <input
              type="text"
              class="form-control"
              id="billSystem"
              name="billSystem"
              placeholder="Sistema de Facturacion"
              value="<%=business[0].billSystem%>"
              readonly
            />
          </div>
          <div class="col-md-4">
            <label for="">Usuario del Sistema de Facturacion</label>
            <input
              type="text"
              class="form-control"
              id="billSystemUser"
              name="billSystemUser"
              placeholder="Usuario del Sistema de Facturacion"
              value="<%=business[0].billSystemUser%>"
              readonly
            />
          </div>
          <div class="col-md-4">
            <label for="">Contrase単a del Sistema de Facturacion</label>
            <input
              type="text"
              class="form-control"
              id="billSystemPassword"
              name="billSystemPassword"
              placeholder="Contrase単a del Sistema de Facturacion"
              value="<%=business[0].billSystemPassword%>"
              readonly
            />
          </div>
        </div>
        <div class="row">
          <div class="col-md-6">
            <label for="">Correo para recepcion de Facturas</label>
            <input
              type="text"
              class="form-control"
              id="billEmail"
              name="billEmail"
              placeholder="Correo para recepcion de Facturas"
              value="<%=business[0].billEmail%>"
              readonly
            />
          </div>
          <div class="col-md-6">
            <label for=""
              >Contrase単a del Correo para recepcion de Facturas</label
            >
            <input
              type="text"
              class="form-control"
              id="billEmailPassword"
              name="billEmailPassword"
              placeholder="Contrase単a del Correo para recepcion de Facturas"
              value="<%=business[0].billEmailPassword%>"
              readonly
            />
          </div>
        </div>
        <div class="row">
          <div class="col-md-6">
            <label for="">Usuario Travi</label>
            <input
              type="text"
              class="form-control"
              id="traviUser"
              name="traviUser"
              placeholder="Usuario Travi"
              value="<%=business[0].traviUser%>"
              readonly
            />
          </div>
          <div class="col-md-6">
            <label for="">Contrase単a Travi</label>
            <input
              type="text"
              class="form-control"
              id="traviPassword"
              name="traviPassword"
              placeholder="Contrase単a Travi"
              value="<%=business[0].traviPassword%>"
              readonly
            />
          </div>
        </div>
        <div class="row">
          <div class="col-md-6">
            <label for="">Usuario CCSS</label>
            <input
              type="text"
              class="form-control"
              id="ccssUser"
              name="ccssUser"
              placeholder="Usuario CCSS"
              value="<%=business[0].ccssUser%>"
              readonly
            />
          </div>
          <div class="col-md-6">
            <label for="">Contrase単a CCSS</label>
            <input
              type="text"
              class="form-control"
              id="ccssPassword"
              name="ccssPassword"
              placeholder="Contrase単a CCSS"
              value="<%=business[0].ccssPassword%>"
              readonly
            />
          </div>
        </div>
        <div class="row">
          <div class="col-md-6">
            <label for="">Usuario INS</label>
            <input
              type="text"
              class="form-control"
              id="insUser"
              name="insUser"
              placeholder="Usuario INS"
              value="<%=business[0].insUser%>"
              readonly
            />
          </div>
          <div class="col-md-6">
            <label for="">Contrase単a INS</label>
            <input
              type="text"
              class="form-control"
              id="insPassword"
              name="insPassword"
              placeholder="Contrase単a INS"
              value="<%=business[0].insPassword%>"
              readonly
            />
          </div>
        </div>
        <div class="row">
          <div class="col-md-2">
            <label for="">Agente encargado*</label>
            <select
              name="userCharge"
              id="userCharge"
              class="form-select"
              list="datalistOptions"
              autocomplete="off"
              disabled="true"
            >
              <option value="<%=user[0].id%>" selected>
                <%=user[0].userName%>
              </option>
              <% var p=0; totalUsers.forEach(function(totalUsersData){ %>
              <option value="<%=totalUsersData.id%>">
                <%=totalUsersData.userName%>
              </option>
              <% p++; }) %>
            </select>
          </div>
        </div>
      </div>
    </form>
    <form
      id="businessActivity"
      class="addUserForm needs-validation"
      method="post"
      novalidate
    >
      <h2>Actividad Econ坦mica</h2>
      <input
        name="businessID"
        type="hidden"
        value="<%=business[0].businessID%>"
      />
      <div class="editButtons">
        <button
          type="button"
          class="button"
          id="editActivity"
          onclick="editBusinessActivity()"
        >
          <i class="material-icons">mode_edit</i>
          <span class="text">Editar</span>
        </button>
      </div>
      <div class="editButtons">
        <button type="submit" class="button hiddenButton" id="saveActivityData">
          <i class="material-icons">sd_card</i>
          <span class="text">Guardar</span>
        </button>
      </div>
      <div class="editButtons">
        <button
          type="button"
          class="button hiddenButton"
          id="addActivityButton"
          onclick="cloneActivity2()"
        >
          <i class="material-icons">add</i>
          <span class="text">Agregar Actividad</span>
        </button>
      </div>
      <div class="contentBackground">
        <% var e=0; activity.forEach(function(activityData){ %>
        <div id="activityDIV" class="currentActivities">
          <div class="col-md-6 divDeleteButton" id="divDeleteButton">
            <button
              type="button"
              class="edit deleteButton"
              id="deleteButton"
              onclick="deleteActivityAjx('<%=business[0].businessID%>','<%=activityData.activityID%>','<%=activityData.businessActivityID%>')"
            >
              <i class="deleteIcon material-icons">clear</i>
            </button>
          </div>
          <div class="row" id="<%=activityData.businessActivityID%>">
            <div class="col-md-6" id="businessActivityInput">
              <input
                name="businessCurrentActivitiesID"
                type="hidden"
                value="<%=activityData.businessActivityID%>"
              />
              <select
                name="businessCurrentActivities"
                id="businessActivity"
                class="form-select currentActivity"
                disabled
                required
              >
                <option value="<%=activityData.activityID%>" selected>
                  <%=activityData.activityName%>
                </option>
                <% var n=0; totalActivity.forEach(function(totalActivityData){
                %>
                <option value="<%=totalActivityData.id%>">
                  <%=totalActivityData.activityName%>
                </option>
                <% n++; }) %>
              </select>
            </div>
          </div>
        </div>
        <% e++; }) %>
        <div id="addActivity" class="addActivity"></div>
      </div>
    </form>
    <form id="tivData" class="addUserForm" action="/saveTivData" method="post">
      <h2>TIV</h2>
      <input
        name="businessID"
        type="hidden"
        value="<%=business[0].businessID%>"
      />
      <div class="editButtons">
        <button
          type="button"
          class="edit editTIV"
          id="editTIV"
          onclick="editBusinessTivData()"
        >
          <i class="material-icons" style="font-size: 2rem">mode_edit</i>
        </button>
      </div>
      <div class="table-responsive">
        <table class="table table-dark table-striped table-bordered tiv">
          <tr>
            <th scope="col">A</th>
            <th scope="col">B</th>
            <th scope="col">C</th>
            <th scope="col">D</th>
            <th scope="col">E</th>
            <th scope="col">F</th>
            <th scope="col">G</th>
            <th scope="col">H</th>
            <th scope="col">I</th>
            <th scope="col">J</th>
            <th scope="col">K</th>
            <th scope="col">L</th>
            <th scope="col">M</th>
            <th scope="col">N</th>
            <th scope="col">O</th>
          </tr>
          <tr>
            <th>
              <input
                size="1"
                type="text"
                id="a"
                name="a"
                value="<%=business[0].TIV.charAt(0)%><%=business[0].TIV.charAt(1)%>"
                readonly
              />
            </th>
            <th>
              <input
                size="1"
                type="text"
                id="b"
                name="b"
                value="<%=business[0].TIV.charAt(3)%><%=business[0].TIV.charAt(4)%>"
                readonly
              />
            </th>
            <th>
              <input
                size="1"
                type="text"
                id="c"
                name="c"
                value="<%=business[0].TIV.charAt(6)%><%=business[0].TIV.charAt(7)%>"
                readonly
              />
            </th>
            <th>
              <input
                size="1"
                type="text"
                id="d"
                name="d"
                value="<%=business[0].TIV.charAt(9)%><%=business[0].TIV.charAt(10)%>"
                readonly
              />
            </th>
            <th>
              <input
                size="1"
                type="text"
                id="e"
                name="e"
                value="<%=business[0].TIV.charAt(12)%><%=business[0].TIV.charAt(13)%>"
                readonly
              />
            </th>
            <th>
              <input
                size="1"
                type="text"
                id="f"
                name="f"
                value="<%=business[0].TIV.charAt(15)%><%=business[0].TIV.charAt(16)%>"
                readonly
              />
            </th>
            <th>
              <input
                size="1"
                type="text"
                id="g"
                name="g"
                value="<%=business[0].TIV.charAt(18)%><%=business[0].TIV.charAt(19)%>"
                readonly
              />
            </th>
            <th>
              <input
                size="1"
                type="text"
                id="h"
                name="h"
                value="<%=business[0].TIV.charAt(21)%><%=business[0].TIV.charAt(22)%>"
                readonly
              />
            </th>
            <th>
              <input
                size="1"
                type="text"
                id="i"
                name="i"
                value="<%=business[0].TIV.charAt(24)%><%=business[0].TIV.charAt(25)%>"
                readonly
              />
            </th>
            <th>
              <input
                size="1"
                type="text"
                id="j"
                name="j"
                value="<%=business[0].TIV.charAt(27)%><%=business[0].TIV.charAt(28)%>"
                readonly
              />
            </th>
            <th>
              <input
                size="1"
                type="text"
                id="k"
                name="k"
                value="<%=business[0].TIV.charAt(30)%><%=business[0].TIV.charAt(31)%>"
                readonly
              />
            </th>
            <th>
              <input
                size="1"
                type="text"
                id="l"
                name="l"
                value="<%=business[0].TIV.charAt(33)%><%=business[0].TIV.charAt(34)%>"
                readonly
              />
            </th>
            <th>
              <input
                size="1"
                type="text"
                id="m"
                name="m"
                value="<%=business[0].TIV.charAt(36)%><%=business[0].TIV.charAt(37)%>"
                readonly
              />
            </th>
            <th>
              <input
                size="1"
                type="text"
                id="n"
                name="n"
                value="<%=business[0].TIV.charAt(39)%><%=business[0].TIV.charAt(40)%>"
                readonly
              />
            </th>
            <th>
              <input
                size="1"
                type="text"
                id="o"
                name="o"
                value="<%=business[0].TIV.charAt(42)%><%=business[0].TIV.charAt(43)%>"
                readonly
              />
            </th>
          </tr>
        </table>
      </div>
      <h2>Logo</h2>
      <div class="contentBackground">
        <div class="row">
          <div class="col-md-6">
            <input type="file" class="form-control" name="picture" />
          </div>
        </div>
      </div>
    </form>
    <form
      id="userData"
      class="addUserForm"
      action="/saveUserData"
      method="post"
    >
      <h2>Contacto</h2>
      <div class="editButtons">
        <button
          type="button"
          class="edit"
          id="editContactsData"
          onclick="editContactData()"
        >
          <i class="material-icons" style="font-size: 2rem">mode_edit</i>
        </button>
      </div>
      <div class="contentBackground">
        <% var p=0; contact.forEach(function(contactData){ %>
        <div id="contact">
          <div id="contactDIV1">
            <div class="row">
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control"
                  id="contactName"
                  name="contactName"
                  placeholder="Nombre"
                  value="<%=contactData.contactName%>"
                  readonly
                />
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control"
                  \
                  id="contactPhone"
                  name="contactPhone"
                  placeholder="Numero Telefonico"
                  value="<%=contactData.contactPhone%>"
                  readonly
                />
              </div>
              <div class="col-md-4">
                <input
                  type="text"
                  class="form-control"
                  id="contactEmail"
                  name="contactEmail"
                  placeholder="Correo electronico"
                  value="<%=contactData.contactEmail%>"
                  readonly
                />
              </div>
            </div>
          </div>
        </div>
        <% p++; }) %>
      </div>
    </form>
    <div
      class="modal fade"
      id="businessModal"
      tabindex="-1"
      aria-labelledby="businessModal"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="businessModalTitle">Mensaje:</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body" id="businessModalMessage"></div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Entiendo
            </button>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script>
    var i = 1;
    var j = 1;
    var z = 1;
    var newOwnerCount = 1;
    var newContactCount = 1;
    var newActivityCount = 1;

    window.addEventListener("load", (event) => {
      $("#navBar").load("/assets/navbar.html");
    });

    (function () {
      "use strict";

      // Fetch all the forms we want to apply custom Bootstrap validation styles to
      var ownerDataValidation = $("#ownerData");

      // Loop over them and prevent submission
      Array.prototype.slice.call(ownerDataValidation).forEach(function (form) {
        form.addEventListener(
          "submit",
          function (event) {
            if (!form.checkValidity()) {
              event.preventDefault();
              event.stopPropagation();
            }
            if (form.checkValidity()) {
              var formData = JSON.stringify($("#ownerData").serializeArray());
              formData = JSON.parse(formData);
              $.ajax({
                type: "POST",
                url: "/saveBusinessOwner",
                data: {
                  formData: formData,
                },
                success: function (data, status) {
                  $(".businessOwnerName").attr("readonly", true);
                  $(".businessOwnerID").attr("readonly", true);
                  $(".ownerIDExpDate").attr("readonly", true);
                  $(".ownerBirDate").attr("readonly", true);
                  $(".ownerAddress").attr("readonly", true);
                  $(".newBusinessOwnerName").attr("readonly", true);
                  $(".newBusinessOwnerID").attr("readonly", true);
                  $(".newOwnerIDExpDate").attr("readonly", true);
                  $(".newOwnerBirDate").attr("readonly", true);
                  $(".newOwnerAddress").attr("readonly", true);
                  setTimeout(() => {
                    $(".newBusinessOwnerName").attr(
                      "name",
                      "currentBusinessOwnerName"
                    );
                    $(".newBusinessOwnerName").attr(
                      "class",
                      "form-control businessOwnerName"
                    );
                    $(".newBusinessOwnerID").attr(
                      "name",
                      "currentBusinessOwnerID"
                    );
                    $(".newBusinessOwnerID").attr(
                      "class",
                      "form-control businessOwnerID"
                    );
                    $(".newOwnerIDExpDate").attr(
                      "name",
                      "currentOwnerIDExpDate"
                    );
                    $(".newOwnerIDExpDate").attr(
                      "class",
                      "form-control ownerIDExpDate"
                    );
                    $(".newOwnerBirDate").attr("name", "currentOwnerBirDate");
                    $(".newOwnerBirDate").attr(
                      "class",
                      "form-control ownerBirDate"
                    );
                    $(".newOwnerAddress").attr("name", "currentOwnerAddress");
                    $(".newOwnerAddress").attr(
                      "class",
                      "form-control ownerAddress"
                    );
                  }, 300);
                  console.log(formData);
                  $(".editOwner").css("display", "inline");
                  $("#saveOwnerDataButton").css("display", "none");
                  $("#addOwnerButton").css("display", "none");
                  $("#editOwner").css("display", "inline-flex");
                  $("#businessModal").modal("show");
                  $(".divDeleteButtonOwner").css("display", "none");
                  $("#businessModalMessage").text(
                    "Representante(s) Legal Guardados"
                  );
                },
              });
            }
            form.classList.add("was-validated");
            event.preventDefault();
          },
          false
        );
      });

      var businessActivity = $("#businessActivity");

      // Loop over them and prevent submission
      Array.prototype.slice.call(businessActivity).forEach(function (form) {
        form.addEventListener(
          "submit",
          function (event) {
            if (!form.checkValidity()) {
              event.preventDefault();
              event.stopPropagation();
            }
            if (form.checkValidity()) {
              var formData = JSON.stringify(
                $("#businessActivity").serializeArray()
              );
              formData = JSON.parse(formData);
              $.ajax({
                type: "POST",
                url: "/saveBusinessActivity",
                data: {
                  formData: formData,
                },
                success: function (data, status) {
                  $(".divDeleteButton").css("display", "none");
                  $(".currentActivity").prop("disabled", true);
                  $("#saveActivityData").css("display", "none");
                  $("#addActivityButton").css("display", "none");
                  $("#editActivity").css("display", "inline-flex");
                  $(".deleteButton").css("display", "none");
                  $(".businessNewActivities").attr("readonly", true);
                  $(".businessNewActivities").attr(
                    "name",
                    "businessCurrentActivities"
                  );
                  $(".businessNewActivities").attr(
                    "class",
                    "form-control  currentActivity"
                  );
                  $("#newActivity3").attr("id", "newActivity4");
                  $("#businessModal").modal("show");
                  $("#businessModalMessage").text("Actividades guardadas");
                },
              });
            }
            form.classList.add("was-validated");
            event.preventDefault();
          },
          false
        );
      });
      var generalData = $("#generalData");

      // Loop over them and prevent submission
      Array.prototype.slice.call(generalData).forEach(function (form) {
        form.addEventListener(
          "submit",
          function (event) {
            if (!form.checkValidity()) {
              event.preventDefault();
              event.stopPropagation();
            }
            if (form.checkValidity()) {
              var formData = JSON.stringify($("#generalData").serializeArray());
              formData = JSON.parse(formData);
              $.ajax({
                type: "POST",
                url: "/saveGeneralData",
                data: {
                  formData: formData,
                },
                success: function (data, status) {
                  $("#businessName").attr("readonly", true);
                  $("#editGeneralData").css("display", "inline-flex");
                  $("#saveGeneralData").css("display", "none");
                  $("#businessModal").modal("show");
                  $("#businessModalMessage").text("Datos Generales guardados");
                },
              });
            }
            form.classList.add("was-validated");
            event.preventDefault();
          },
          false
        );
      });

      var accountData = $("#accountData");

      // Loop over them and prevent submission
      Array.prototype.slice.call(accountData).forEach(function (form) {
        form.addEventListener(
          "submit",
          function (event) {
            if (!form.checkValidity()) {
              event.preventDefault();
              event.stopPropagation();
            }
            if (form.checkValidity()) {
              var formData = JSON.stringify($("#accountData").serializeArray());
              formData = JSON.parse(formData);
              $.ajax({
                type: "POST",
                url: "/saveAccountsData",
                data: {
                  formData: formData,
                },
                success: function (data, status) {
                  $("#atvUser").attr("readonly", true);
                  $("#atvPassword").attr("readonly", true);
                  $("#billSystem").attr("readonly", true);
                  $("#billSystemUser").attr("readonly", true);
                  $("#billSystemPassword").attr("readonly", true);
                  $("#billEmail").attr("readonly", true);
                  $("#billEmailPassword").attr("readonly", true);
                  $("#traviUser").attr("readonly", true);
                  $("#traviPassword").attr("readonly", true);
                  $("#ccssUser").attr("readonly", true);
                  $("#ccssPassword").attr("readonly", true);
                  $("#insUser").attr("readonly", true);
                  $("#insPassword").attr("readonly", true);
                  $("#userCharge").prop("disabled", true);
                  $("#editAccountData").css("display", "inline-flex");
                  $("#saveAccountData").css("display", "none");
                  $("#businessModal").modal("show");
                  $("#businessModalMessage").text("Datos Contables Guardados");
                },
              });
            }
            form.classList.add("was-validated");
            event.preventDefault();
          },
          false
        );
      });
    })();
  </script>
</html>
